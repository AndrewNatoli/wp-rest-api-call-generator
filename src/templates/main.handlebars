import fetch from '@apicase/adapter-fetch'
import { ApiService } from '@apicase/services';

const WordpressService = new ApiService({
  fetch,
  url: "{{WP_API_URL}}"
});

{{#each endpoints}}
export const {{this.name}} = ({{#each this.params}}{{@key}}{{#if @last}}{{#if this.args }} args = {} {{/if}}{{else}},{{/if}}{{/each}}) => {

  {{#each this.args}}
  {{#if @first}}
  const body = {};
  {{/if}}
  if (args.{{@key}} !== undefined) {
    body.{{@key}} = args.{{@key}}
  } {{#if this.required}}else {
    throw Error('{{@key}} is required')
  }{{/if}}
  {{/each}}

  return WordpressService.doRequest({
    url: {{{this.route}}},
    method: {{this.method}},
    {{#each this.args}}
    {{#if @first}}
    body
    {{/if}}
    {{/each}}
  })
}
{{/each}}
{{!--  
  getPostsById:
   { route: '/wp/v2/posts/:id',
     name: 'getPostsById',
     params: { id: [Object] },
     args: { context: [Object], password: [Object] } },
--}}